{"version":3,"file":"side-popup.min.js","sources":["../src/options.js","../src/functions.js","../src/SidePopup.js"],"sourcesContent":["export default {\r\n    attrs: {\r\n        class: 'modal',\r\n        tabindex: '-1',\r\n    },\r\n    header: {\r\n        show: true,\r\n        tag: 'div',\r\n        showCloseBtn: true,\r\n        attrs: {\r\n            class: 'modal-header',\r\n        },\r\n    },\r\n    body: {\r\n        show: true,\r\n        tag: 'div',\r\n        attrs: {\r\n            class: 'modal-body',\r\n        },\r\n    },\r\n    footer: {\r\n        show: true,\r\n        tag: 'div',\r\n        attrs: {\r\n            class: 'modal-footer',\r\n        },\r\n    },\r\n    buttons: [{\r\n        html: '确定',\r\n        attrs: {\r\n            class: 'btn btn-primary',\r\n            type: 'button',\r\n        },\r\n    }],\r\n};","import $ from 'jquery';\r\nimport styles from './styles.css';\r\n\r\n\r\n/**\r\n * 初始化 DOM\r\n * @param {SidePopup} instance \r\n * @returns {jQuery}\r\n */\r\nexport function initDOM(instance) {\r\n    const opts = instance.options;\r\n    const $el = $(`<div ${$.map(opts.attrs, (v, k) => `${k}=\"${v}\"`).join(' ')}></div>`);\r\n    $el.addClass(instance.constructor.id);\r\n    $el.addClass(opts.type === 'left' ? 'left' : 'right');\r\n    if (opts.addedClass) $el.addClass(opts.addedClass);\r\n    return $el.append(initDialog(opts, instance));\r\n}\r\n\r\n\r\n/**\r\n * 初始化 modal-dialog\r\n * @param {object} opts \r\n * @param {SidePopup} instance \r\n * @returns {jQuery}\r\n */\r\nexport function initDialog(opts, instance) {\r\n    const $content = $('<div class=\"modal-content\"></div>');\r\n    if (opts.header.show) {\r\n        $content.append(initHeader(opts.header, instance));\r\n    }\r\n    if (opts.body.show) {\r\n        $content.append(initBody(opts.body));\r\n    }\r\n    if (opts.footer.show) {\r\n        const $footer = initBody(opts.footer);    // footer 的处理逻辑与 body 一样\r\n        if (opts.buttons) {\r\n            initButtons($footer, opts.buttons);\r\n        }\r\n        $content.append($footer);\r\n    }\r\n    const $dialog = $('<div class=\"modal-dialog\"></div>').append($content);\r\n    if (opts.width) $dialog.css('width', opts.width);\r\n    return $dialog;\r\n}\r\n\r\n\r\n/**\r\n * 初始化 modal-header\r\n * @param {object} opts \r\n * @param {SidePopup} instance \r\n * @returns {jQuery}\r\n */\r\nfunction initHeader(opts, instance) {\r\n    const $header = $(`<${opts.tag} ${$.map(opts.attrs, (v, k) => `${k}=\"${v}\"`).join(' ')}></${opts.tag}>`);\r\n    if (opts.showCloseBtn) {\r\n        const $btn = $('<button class=\"close\" type=\"button\">&times;</button>');\r\n        if (instance) {\r\n            $btn.click(_ => instance.close());\r\n        } else {\r\n            $btn.click(function () {\r\n                $header.parent().parent().remove();\r\n            });\r\n        }\r\n        $header.append($btn);\r\n    }\r\n    if (opts.title) {\r\n        $header.append(`<h4 class=\"modal-title\">${opts.title}</h4>`);\r\n    }\r\n    if (opts.addedClass) $header.addClass(opts.addedClass);\r\n    if (opts.html) $header.append(opts.html);\r\n    return $header;\r\n}\r\n\r\n\r\n/**\r\n * 初始化 modal-body\r\n * @param {object} opts \r\n * @returns {jQuery}\r\n */\r\nfunction initBody(opts) {\r\n    const $el = $(`<${opts.tag} ${$.map(opts.attrs, (v, k) => `${k}=\"${v}\"`).join(' ')}></${opts.tag}>`);\r\n    if (opts.addedClass) $el.addClass(opts.addedClass);\r\n    if (opts.html) $el.append(opts.html);\r\n    return $el;\r\n}\r\n\r\n\r\n/**\r\n * 初始化按钮\r\n * @param {jQuery} $parent 父元素\r\n * @param {object[]} opts \r\n */\r\nfunction initButtons($parent, opts) {\r\n    $.each(opts, (_, item) => {\r\n        const $btn = $(`<button ${$.map(item.attrs, (v, k) => `${k}=\"${v}\"`).join(' ')}></button>`);\r\n        if (item.addedClass) $btn.addClass(item.addedClass);\r\n        if (item.html) $btn.append(item.html);\r\n        if (item.onClick) $btn.click(item.onClick);\r\n        $parent.append($btn);\r\n    });\r\n}\r\n\r\n\r\n/**\r\n * 增加样式\r\n * @param {string} id \r\n */\r\nexport function appendStyles(id) {\r\n    let html = `<style class=\"ID\" type=\"text/css\">${styles}</style>`;\r\n    html = html.replace(/ID/g, id);\r\n    $(document.body).append(html);\r\n}","import options from './options';\r\nimport $ from 'jquery';\r\nimport {initDOM, initDialog, appendStyles} from './functions';\r\n\r\n\r\nexport default class SidePopup {\r\n    static id = 'SIDE_POPUP';\r\n    static defaultOptions = options;\r\n\r\n\r\n    constructor(opts) {\r\n        this.options = $.extend(true, opts, options);\r\n        this.element = initDOM(this);\r\n        this.element.data(SidePopup.id, this);  // 挂载组件对象到元素上\r\n        this.element.appendTo(document.body);\r\n        if (!$(`style.${SidePopup.id}`).length) {\r\n            appendStyles(SidePopup.id);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 打开弹窗（插入到 document 中）\r\n     */\r\n    open() {\r\n        this.element.appendTo(document.body);\r\n        this.element.show();\r\n    }\r\n\r\n\r\n    /**\r\n     * 关闭弹窗（从 document 中移除）\r\n     */\r\n    close() {\r\n        this.element.remove();\r\n        this.element\r\n            .children('.modal-dialog')\r\n            .not(':first')\r\n            .remove();\r\n    }\r\n\r\n\r\n    /**\r\n     * 显示弹窗\r\n     */\r\n    show() {\r\n        this.element.show();\r\n    }\r\n\r\n\r\n    /**\r\n     * 隐藏弹窗\r\n     */\r\n    hide() {\r\n        this.element.hide();\r\n    }\r\n\r\n\r\n    /**\r\n     * 打开子弹窗\r\n     * @param {object} opts \r\n     */\r\n    openSubPopup(opts) {\r\n        $.extend(true, opts, options);\r\n        this.element.append(initDialog(opts));\r\n    }\r\n\r\n\r\n    /**\r\n     * 关闭子弹窗\r\n     */\r\n    closeSubPopup() {\r\n        this.element\r\n            .children('.modal-dialog')\r\n            .not(':first')\r\n            .last()\r\n            .remove();\r\n    }\r\n\r\n\r\n    /**\r\n     * 打开弹窗\r\n     * @param {string|Element|jQuery|object} param \r\n     * @returns {SidePopup}\r\n     */\r\n    static open(param) {\r\n        let popup;\r\n        if (typeof param === 'string' || param instanceof Element || param instanceof $) {\r\n            popup = $(param).data(SidePopup.id);\r\n        } else if (param instanceof Object) {\r\n            popup = new SidePopup(param);\r\n        } else {\r\n            throw new TypeError('错误的参数类型');\r\n        }\r\n        if (popup) {\r\n            popup.open();\r\n            return popup;\r\n        } else {\r\n            throw new Error('组件对象不存在');\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 关闭弹窗\r\n     * @param {string|Element|jQuery} param \r\n     */\r\n    static close(param) {\r\n        const popup = $(param).data(SidePopup.id);\r\n        if (popup) popup.close();\r\n    }\r\n}\r\n"],"names":["attrs","tabindex","header","show","tag","showCloseBtn","body","footer","buttons","html","type","initDialog","opts","instance","$content","$","append","$header","map","v","k","join","$btn","click","_","close","parent","remove","title","addedClass","addClass","initHeader","initBody","$footer","$parent","each","item","onClick","initButtons","$dialog","width","css","$el","SidePopup","id","options","extend","element","constructor","initDOM","this","data","appendTo","document","length","replace","param","popup","Element","Object","TypeError","open","Error","children","not","hide","last"],"mappings":"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"}