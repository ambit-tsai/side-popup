{"version":3,"file":"side-popup.min.js","sources":["../src/options.js","../src/functions.js","../node_modules/style-inject/dist/style-inject.es.js","../src/SubPopup.js","../src/SidePopup.js"],"sourcesContent":["export default {\r\n    backdrop: false,\r\n    attrs: {\r\n        class: 'modal-dialog',\r\n    },\r\n    header: {\r\n        show: true,\r\n        tag: 'div',\r\n        showCloseBtn: true,\r\n        attrs: {\r\n            class: 'modal-header',\r\n        },\r\n    },\r\n    body: {\r\n        show: true,\r\n        tag: 'div',\r\n        attrs: {\r\n            class: 'modal-body',\r\n        },\r\n    },\r\n    footer: {\r\n        show: true,\r\n        tag: 'div',\r\n        attrs: {\r\n            class: 'modal-footer',\r\n        },\r\n    },\r\n    buttons: [{\r\n        html: '确定',\r\n        attrs: {\r\n            class: 'btn btn-primary',\r\n            type: 'button',\r\n        },\r\n    }],\r\n};","import $ from 'jquery';\r\nimport styles from './styles.css';\r\n\r\n\r\n/**\r\n * 初始化 modal-dialog\r\n * @param {SidePopup|SubPopup} instance\r\n * @returns {jQuery}\r\n */\r\nexport function initDialog(instance) {\r\n    const opts = instance.options;\r\n    const $content = $('<div class=\"modal-content\"></div>');\r\n    if (opts.header.show) {\r\n        $content.append(initHeader(instance));\r\n    }\r\n    if (opts.body.show) {\r\n        $content.append(initBody(opts.body));\r\n    }\r\n    if (opts.footer.show) {\r\n        const $footer = initBody(opts.footer);    // footer 的初始化逻辑与 body 一样\r\n        if (opts.buttons) {\r\n            initButtons($footer, opts.buttons);\r\n        }\r\n        $content.append($footer);\r\n    }\r\n\r\n    const $dialog = $(`<div ${$.map(opts.attrs, (v, k) => `${k}=\"${v}\"`).join(' ')}></div>`);\r\n    if (opts.width) $dialog.css('width', opts.width);\r\n    if (opts.addedClass) $el.addClass(opts.addedClass);\r\n    return $dialog.append($content);\r\n}\r\n\r\n\r\n/**\r\n * 初始化 modal-header\r\n * @param {SubPopup} instance\r\n * @returns {jQuery}\r\n */\r\nfunction initHeader(instance) {\r\n    const opts = instance.options.header;\r\n    const $header = $(`<${opts.tag} ${$.map(opts.attrs, (v, k) => `${k}=\"${v}\"`).join(' ')}></${opts.tag}>`);\r\n    if (opts.showCloseBtn) {\r\n        const $btn = $('<button class=\"close\" type=\"button\">&times;</button>');\r\n        $btn.click(_ => instance.close());\r\n        $header.append($btn);\r\n    }\r\n    if (opts.title) {\r\n        $header.append(`<h4 class=\"modal-title\">${opts.title}</h4>`);\r\n    }\r\n    if (opts.addedClass) $header.addClass(opts.addedClass);\r\n    if (opts.html) $header.append(opts.html);\r\n    return $header;\r\n}\r\n\r\n\r\n/**\r\n * 初始化 modal-body\r\n * @param {object} opts \r\n * @returns {jQuery}\r\n */\r\nfunction initBody(opts) {\r\n    const $el = $(`<${opts.tag} ${$.map(opts.attrs, (v, k) => `${k}=\"${v}\"`).join(' ')}></${opts.tag}>`);\r\n    if (opts.addedClass) $el.addClass(opts.addedClass);\r\n    if (opts.html) $el.append(opts.html);\r\n    return $el;\r\n}\r\n\r\n\r\n/**\r\n * 初始化按钮\r\n * @param {jQuery} $parent 父元素\r\n * @param {object[]} opts \r\n */\r\nfunction initButtons($parent, opts) {\r\n    $.each(opts, (_, item) => {\r\n        const $btn = $(`<button ${$.map(item.attrs, (v, k) => `${k}=\"${v}\"`).join(' ')}></button>`);\r\n        if (item.addedClass) $btn.addClass(item.addedClass);\r\n        if (item.html) $btn.append(item.html);\r\n        if (item.onClick) $btn.click(item.onClick);\r\n        $parent.append($btn);\r\n    });\r\n}\r\n\r\n\r\n/**\r\n * 增加样式\r\n * @param {string} id \r\n */\r\nexport function appendStyles(id) {\r\n    let html = `<style class=\"ID\" type=\"text/css\">${styles}</style>`;\r\n    html = html.replace(/ID/g, id);\r\n    $(document.body).append(html);\r\n}\r\n\r\n\r\n/**\r\n * 初始化 SidePopup\r\n * @param {SidePopup} instance \r\n * @returns {jQuery}\r\n */\r\nexport function initSidePopup(instance) {\r\n    const opts = instance.options;\r\n    const id = instance.constructor.id;\r\n    const $el = $(`<div class=\"modal fade\" tabindex=\"-1\"></div>`);\r\n    $el.addClass(id);\r\n    $el.addClass(opts.type === 'left' ? 'left' : 'right');\r\n    if (opts.backdrop) {\r\n        $el.click(function (event) {\r\n            if (this !== event.target) return;\r\n            if (instance._subPopupList.length) {\r\n                instance.closeSubPopup();\r\n            } else {\r\n                instance.close();\r\n            }\r\n        });\r\n    }\r\n\r\n    const $dialog = initDialog(instance);\r\n    $dialog.data(id, instance); // 挂载组件实例到弹窗上\r\n    return $el.append($dialog);\r\n}\r\n\r\n\r\n/**\r\n * 等待渲染\r\n * @param {function} fn \r\n */\r\nexport function waitForRender(fn) {\r\n    if (Promise) {\r\n        Promise.resolve().then(fn)\r\n    } else {\r\n        setTimeout(fn);\r\n    }\r\n}","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import options from './options';\r\nimport {initDialog} from './functions';\r\n\r\n\r\nexport default class SubPopup {\r\n    options;\r\n    element;\r\n\r\n\r\n    constructor(opts) {\r\n        this.options = $.extend(true, {}, options, opts);\r\n        this.element = initDialog(this);\r\n    }\r\n\r\n\r\n    /**\r\n     * 关闭弹窗（从 document 中移除）\r\n     */\r\n    close() {\r\n        this.element.remove();\r\n    }\r\n}","import options from './options';\r\nimport $ from 'jquery';\r\nimport {appendStyles, initSidePopup, waitForRender} from './functions';\r\nimport SubPopup from './SubPopup';\r\n\r\n\r\nexport default class SidePopup {\r\n    static id = 'SIDE_POPUP';\r\n    static defaultOptions = options;\r\n    options;\r\n    element;\r\n    _subPopupList = [];\r\n\r\n\r\n    constructor(opts) {\r\n        if (!$(`style.${SidePopup.id}`).length) {\r\n            appendStyles(SidePopup.id);         // 添加样式\r\n        }\r\n        this.options = $.extend(true, {}, options, opts);\r\n        this.element = initSidePopup(this);\r\n        this.element.appendTo(document.body);\r\n        if (typeof opts.afterRender === 'function') {\r\n            waitForRender(opts.afterRender);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 打开弹窗（插入到 document 中）\r\n     */\r\n    open() {\r\n        this.show();\r\n        this.element.appendTo(document.body);\r\n    }\r\n\r\n\r\n    /**\r\n     * 关闭弹窗（从 document 中移除）\r\n     */\r\n    close() {\r\n        this.element.remove();\r\n    }\r\n\r\n\r\n    /**\r\n     * 显示弹窗\r\n     */\r\n    show() {\r\n        this.element.addClass('in');\r\n    }\r\n\r\n\r\n    /**\r\n     * 隐藏弹窗\r\n     */\r\n    hide() {\r\n        this.element.removeClass('in');\r\n    }\r\n\r\n\r\n    /**\r\n     * 打开子弹窗\r\n     * @param {object} opts \r\n     */\r\n    openSubPopup(opts) {\r\n        const subPopup = new SubPopup(opts);\r\n        this._subPopupList.push(subPopup);\r\n        this.element.append(subPopup.element);\r\n        if (typeof opts.afterRender === 'function') {\r\n            waitForRender(opts.afterRender);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 关闭子弹窗\r\n     */\r\n    closeSubPopup() {\r\n        const subPopup = this._subPopupList.pop();\r\n        if (subPopup) subPopup.close();\r\n    }\r\n\r\n\r\n    /**\r\n     * 打开弹窗\r\n     * @param {string|Element|jQuery|object} param \r\n     * @returns {SidePopup}\r\n     */\r\n    static open(param) {\r\n        let popup;\r\n        if (typeof param === 'string' || param instanceof Element || param instanceof $) {\r\n            popup = $(param).data(SidePopup.id);\r\n        } else if (param instanceof Object) {\r\n            popup = new SidePopup(param);\r\n        } else {\r\n            throw new TypeError('错误的参数类型');\r\n        }\r\n        if (popup) {\r\n            popup.open();\r\n            return popup;\r\n        } else {\r\n            throw new Error('组件对象不存在');\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 关闭弹窗\r\n     * @param {string|Element|jQuery} param \r\n     */\r\n    static close(param) {\r\n        const popup = $(param).data(SidePopup.id);\r\n        if (popup) popup.close();\r\n    }\r\n}\r\n"],"names":["backdrop","attrs","header","show","tag","showCloseBtn","body","footer","buttons","html","type","initDialog","instance","opts","options","$content","$","append","$header","map","v","k","join","$btn","click","_","close","title","addedClass","addClass","initHeader","initBody","$footer","$parent","each","item","onClick","initButtons","$dialog","width","css","$el","waitForRender","fn","Promise","resolve","then","setTimeout","ref","insertAt","document","head","getElementsByTagName","style","createElement","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","SubPopup","extend","element","this","remove","SidePopup","id","length","styles","replace","constructor","event","target","_subPopupList","closeSubPopup","data","initSidePopup","appendTo","afterRender","removeClass","subPopup","push","pop","param","popup","Element","Object","TypeError","open","Error"],"mappings":";;;;;;;muBAAe,CACXA,UAAU,EACVC,MAAO,OACI,gBAEXC,OAAQ,CACJC,MAAM,EACNC,IAAK,MACLC,cAAc,EACdJ,MAAO,OACI,iBAGfK,KAAM,CACFH,MAAM,EACNC,IAAK,MACLH,MAAO,OACI,eAGfM,OAAQ,CACJJ,MAAM,EACNC,IAAK,MACLH,MAAO,OACI,iBAGfO,QAAS,CAAC,CACNC,KAAM,KACNR,MAAO,OACI,kBACPS,KAAM,+0HCtBX,SAASC,EAAWC,OACjBC,EAAOD,EAASE,QAChBC,EAAWC,EAAE,wCACfH,EAAKX,OAAOC,MACZY,EAASE,OAyBjB,SAAoBL,OACVC,EAAOD,EAASE,QAAQZ,OACxBgB,EAAUF,aAAMH,EAAKT,gBAAOY,EAAEG,IAAIN,EAAKZ,OAAO,SAACmB,EAAGC,mBAASA,eAAMD,UAAME,KAAK,mBAAUT,EAAKT,aAC7FS,EAAKR,aAAc,KACbkB,EAAOP,EAAE,wDACfO,EAAKC,OAAM,SAAAC,UAAKb,EAASc,WACzBR,EAAQD,OAAOM,GAEfV,EAAKc,OACLT,EAAQD,yCAAkCJ,EAAKc,gBAE/Cd,EAAKe,YAAYV,EAAQW,SAAShB,EAAKe,YACvCf,EAAKJ,MAAMS,EAAQD,OAAOJ,EAAKJ,aAC5BS,EAtCaY,CAAWlB,IAE3BC,EAAKP,KAAKH,MACVY,EAASE,OAAOc,EAASlB,EAAKP,OAE9BO,EAAKN,OAAOJ,KAAM,KACZ6B,EAAUD,EAASlB,EAAKN,QAC1BM,EAAKL,SAqDjB,SAAqByB,EAASpB,GAC1BG,EAAEkB,KAAKrB,GAAM,SAACY,EAAGU,OACPZ,EAAOP,oBAAaA,EAAEG,IAAIgB,EAAKlC,OAAO,SAACmB,EAAGC,mBAASA,eAAMD,UAAME,KAAK,oBACtEa,EAAKP,YAAYL,EAAKM,SAASM,EAAKP,YACpCO,EAAK1B,MAAMc,EAAKN,OAAOkB,EAAK1B,MAC5B0B,EAAKC,SAASb,EAAKC,MAAMW,EAAKC,SAClCH,EAAQhB,OAAOM,MA1DXc,CAAYL,EAASnB,EAAKL,SAE9BO,EAASE,OAAOe,OAGdM,EAAUtB,iBAAUA,EAAEG,IAAIN,EAAKZ,OAAO,SAACmB,EAAGC,mBAASA,eAAMD,UAAME,KAAK,wBACtET,EAAK0B,OAAOD,EAAQE,IAAI,QAAS3B,EAAK0B,OACtC1B,EAAKe,YAAYa,IAAIZ,SAAShB,EAAKe,YAChCU,EAAQrB,OAAOF,GA+B1B,SAASgB,EAASlB,OACR4B,EAAMzB,aAAMH,EAAKT,gBAAOY,EAAEG,IAAIN,EAAKZ,OAAO,SAACmB,EAAGC,mBAASA,eAAMD,UAAME,KAAK,mBAAUT,EAAKT,iBACzFS,EAAKe,YAAYa,EAAIZ,SAAShB,EAAKe,YACnCf,EAAKJ,MAAMgC,EAAIxB,OAAOJ,EAAKJ,MACxBgC,EA+DJ,SAASC,EAAcC,GACtBC,QACAA,QAAQC,UAAUC,KAAKH,GAEvBI,WAAWJ,ICnInB,SAAqBH,EAAKQ,QACX,IAARA,IAAiBA,EAAM,QACxBC,EAAWD,EAAIC,YAEdT,GAA2B,oBAAbU,cAEfC,EAAOD,SAASC,MAAQD,SAASE,qBAAqB,QAAQ,GAC9DC,EAAQH,SAASI,cAAc,SACnCD,EAAM3C,KAAO,WAEI,QAAbuC,GACEE,EAAKI,WACPJ,EAAKK,aAAaH,EAAOF,EAAKI,YAKhCJ,EAAKM,YAAYJ,GAGfA,EAAMK,WACRL,EAAMK,WAAWC,QAAUnB,EAE3Ba,EAAMI,YAAYP,SAASU,eAAepB,aCnBzBqB,wBAKLhD,oEACHC,QAAUE,EAAE8C,QAAO,EAAM,GAAIhD,EAASD,QACtCkD,QAAUpD,EAAWqD,qDAQrBD,QAAQE,kBCbAC,wBAQLrD,GH0ET,IAAsBsD,EACrB1D,qFG9EY,IAIPO,kBAAWkD,EAAUC,KAAMC,SHyEXD,EGxEJD,EAAUC,GH0E/B1D,GADIA,8CAA4C4D,eACpCC,QAAQ,MAAOH,GAC3BnD,EAAEkC,SAAS5C,MAAMW,OAAOR,SGzEfK,QAAUE,EAAE8C,QAAO,EAAM,GAAIhD,EAASD,QACtCkD,QHiFN,SAAuBnD,OACpBC,EAAOD,EAASE,QAChBqD,EAAKvD,EAAS2D,YAAYJ,GAC1B1B,EAAMzB,kDACZyB,EAAIZ,SAASsC,GACb1B,EAAIZ,SAAuB,SAAdhB,EAAKH,KAAkB,OAAS,SACzCG,EAAKb,UACLyC,EAAIjB,OAAM,SAAUgD,GACZR,OAASQ,EAAMC,SACf7D,EAAS8D,cAAcN,OACvBxD,EAAS+D,gBAET/D,EAASc,gBAKfY,EAAU3B,EAAWC,UAC3B0B,EAAQsC,KAAKT,EAAIvD,GACV6B,EAAIxB,OAAOqB,GGpGCuC,CAAcb,WACxBD,QAAQe,SAAS5B,SAAS5C,MACC,mBAArBO,EAAKkE,aACZrC,EAAc7B,EAAKkE,2DASlB5E,YACA4D,QAAQe,SAAS5B,SAAS5C,2CAQ1ByD,QAAQE,6CAQRF,QAAQlC,SAAS,0CAQjBkC,QAAQiB,YAAY,2CAQhBnE,OACHoE,EAAW,IAAIpB,EAAShD,QACzB6D,cAAcQ,KAAKD,QACnBlB,QAAQ9C,OAAOgE,EAASlB,SACG,mBAArBlD,EAAKkE,aACZrC,EAAc7B,EAAKkE,yDASjBE,EAAWjB,KAAKU,cAAcS,MAChCF,GAAUA,EAASvD,uCASf0D,OACJC,KACiB,iBAAVD,GAAsBA,aAAiBE,SAAWF,aAAiBpE,EAC1EqE,EAAQrE,EAAEoE,GAAOR,KAAKV,EAAUC,QAC7B,CAAA,KAAIiB,aAAiBG,cAGlB,IAAIC,UAAU,WAFpBH,EAAQ,IAAInB,EAAUkB,MAItBC,SACAA,EAAMI,OACCJ,QAED,IAAIK,MAAM,yCASXN,OACHC,EAAQrE,EAAEoE,GAAOR,KAAKV,EAAUC,IAClCkB,GAAOA,EAAM3D,0BA1GJwC,OACL,gBADKA,mBAEOpD"}