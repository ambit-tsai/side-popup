{"version":3,"file":"side-popup.min.js","sources":["../src/options.js","../src/functions.js","../src/SubPopup.js","../src/SidePopup.js"],"sourcesContent":["export default {\r\n    backdrop: false,\r\n    attrs: {\r\n        class: 'modal-dialog',\r\n    },\r\n    header: {\r\n        show: true,\r\n        tag: 'div',\r\n        showCloseBtn: true,\r\n        attrs: {\r\n            class: 'modal-header',\r\n        },\r\n    },\r\n    body: {\r\n        show: true,\r\n        tag: 'div',\r\n        attrs: {\r\n            class: 'modal-body',\r\n        },\r\n    },\r\n    footer: {\r\n        show: true,\r\n        tag: 'div',\r\n        attrs: {\r\n            class: 'modal-footer',\r\n        },\r\n    },\r\n    buttons: [{\r\n        html: '确定',\r\n        attrs: {\r\n            class: 'btn btn-primary',\r\n            type: 'button',\r\n        },\r\n    }],\r\n};","import $ from 'jquery';\r\nimport styles from './styles.css';\r\n\r\n\r\n/**\r\n * 初始化 modal-dialog\r\n * @param {SidePopup|SubPopup} instance\r\n * @returns {jQuery}\r\n */\r\nexport function initDialog(instance) {\r\n    const opts = instance.options;\r\n    const $content = $('<div class=\"modal-content\"></div>');\r\n    if (opts.header.show) {\r\n        $content.append(initHeader(instance));\r\n    }\r\n    if (opts.body.show) {\r\n        $content.append(initBody(opts.body));\r\n    }\r\n    if (opts.footer.show) {\r\n        const $footer = initBody(opts.footer);    // footer 的初始化逻辑与 body 一样\r\n        if (opts.buttons) {\r\n            initButtons($footer, opts.buttons);\r\n        }\r\n        $content.append($footer);\r\n    }\r\n\r\n    const $dialog = $(`<div ${$.map(opts.attrs, (v, k) => `${k}=\"${v}\"`).join(' ')}></div>`);\r\n    if (opts.width) $dialog.css('width', opts.width);\r\n    if (opts.addedClass) $el.addClass(opts.addedClass);\r\n    return $dialog.append($content);\r\n}\r\n\r\n\r\n/**\r\n * 初始化 modal-header\r\n * @param {SubPopup} instance\r\n * @returns {jQuery}\r\n */\r\nfunction initHeader(instance) {\r\n    const opts = instance.options.header;\r\n    const $header = $(`<${opts.tag} ${$.map(opts.attrs, (v, k) => `${k}=\"${v}\"`).join(' ')}></${opts.tag}>`);\r\n    if (opts.showCloseBtn) {\r\n        const $btn = $('<button class=\"close\" type=\"button\">&times;</button>');\r\n        $btn.click(_ => instance.close());\r\n        $header.append($btn);\r\n    }\r\n    if (opts.title) {\r\n        $header.append(`<h4 class=\"modal-title\">${opts.title}</h4>`);\r\n    }\r\n    if (opts.addedClass) $header.addClass(opts.addedClass);\r\n    if (opts.html) $header.append(opts.html);\r\n    return $header;\r\n}\r\n\r\n\r\n/**\r\n * 初始化 modal-body\r\n * @param {object} opts \r\n * @returns {jQuery}\r\n */\r\nfunction initBody(opts) {\r\n    const $el = $(`<${opts.tag} ${$.map(opts.attrs, (v, k) => `${k}=\"${v}\"`).join(' ')}></${opts.tag}>`);\r\n    if (opts.addedClass) $el.addClass(opts.addedClass);\r\n    if (opts.html) $el.append(opts.html);\r\n    return $el;\r\n}\r\n\r\n\r\n/**\r\n * 初始化按钮\r\n * @param {jQuery} $parent 父元素\r\n * @param {object[]} opts \r\n */\r\nfunction initButtons($parent, opts) {\r\n    $.each(opts, (_, item) => {\r\n        const $btn = $(`<button ${$.map(item.attrs, (v, k) => `${k}=\"${v}\"`).join(' ')}></button>`);\r\n        if (item.addedClass) $btn.addClass(item.addedClass);\r\n        if (item.html) $btn.append(item.html);\r\n        if (item.onClick) $btn.click(item.onClick);\r\n        $parent.append($btn);\r\n    });\r\n}\r\n\r\n\r\n/**\r\n * 增加样式\r\n * @param {string} id \r\n */\r\nexport function appendStyles(id) {\r\n    let html = `<style class=\"ID\" type=\"text/css\">${styles}</style>`;\r\n    html = html.replace(/ID/g, id);\r\n    $(document.body).append(html);\r\n}\r\n\r\n\r\n/**\r\n * 初始化 SidePopup\r\n * @param {SidePopup} instance \r\n * @returns {jQuery}\r\n */\r\nexport function initSidePopup(instance) {\r\n    const opts = instance.options;\r\n    const id = instance.constructor.id;\r\n    const $el = $(`<div class=\"modal fade\" tabindex=\"-1\"></div>`);\r\n    $el.addClass(id);\r\n    $el.addClass(opts.type === 'left' ? 'left' : 'right');\r\n    if (opts.backdrop) {\r\n        $el.click(function (event) {\r\n            if (this !== event.target) return;\r\n            if (instance._subPopupList.length) {\r\n                instance.closeSubPopup();\r\n            } else {\r\n                instance.close();\r\n            }\r\n        });\r\n    }\r\n\r\n    const $dialog = initDialog(instance);\r\n    $dialog.data(id, instance); // 挂载组件实例到弹窗上\r\n    return $el.append($dialog);\r\n}\r\n\r\n\r\n/**\r\n * 等待渲染\r\n * @param {function} fn \r\n */\r\nexport function waitForRender(fn) {\r\n    if (Promise) {\r\n        Promise.resolve().then(fn)\r\n    } else {\r\n        setTimeout(fn);\r\n    }\r\n}","import options from './options';\r\nimport {initDialog} from './functions';\r\n\r\n\r\nexport default class SubPopup {\r\n    options;\r\n    element;\r\n\r\n\r\n    constructor(opts) {\r\n        this.options = $.extend(true, {}, options, opts);\r\n        this.element = initDialog(this);\r\n    }\r\n\r\n\r\n    /**\r\n     * 关闭弹窗（从 document 中移除）\r\n     */\r\n    close() {\r\n        this.element.remove();\r\n    }\r\n}","import options from './options';\r\nimport $ from 'jquery';\r\nimport {appendStyles, initSidePopup, waitForRender} from './functions';\r\nimport SubPopup from './SubPopup';\r\n\r\n\r\nexport default class SidePopup {\r\n    static id = 'SIDE_POPUP';\r\n    static defaultOptions = options;\r\n    options;\r\n    element;\r\n    _subPopupList = [];\r\n\r\n\r\n    constructor(opts) {\r\n        if (!$(`style.${SidePopup.id}`).length) {\r\n            appendStyles(SidePopup.id);         // 添加样式\r\n        }\r\n        this.options = $.extend(true, {}, options, opts);\r\n        this.element = initSidePopup(this);\r\n        this.element.appendTo(document.body);\r\n        if (typeof opts.afterRender === 'function') {\r\n            waitForRender(opts.afterRender);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 打开弹窗（插入到 document 中）\r\n     */\r\n    open() {\r\n        this.show();\r\n        this.element.appendTo(document.body);\r\n    }\r\n\r\n\r\n    /**\r\n     * 关闭弹窗（从 document 中移除）\r\n     */\r\n    close() {\r\n        this.element.remove();\r\n    }\r\n\r\n\r\n    /**\r\n     * 显示弹窗\r\n     */\r\n    show() {\r\n        this.element.addClass('in');\r\n    }\r\n\r\n\r\n    /**\r\n     * 隐藏弹窗\r\n     */\r\n    hide() {\r\n        this.element.removeClass('in');\r\n    }\r\n\r\n\r\n    /**\r\n     * 打开子弹窗\r\n     * @param {object} opts \r\n     */\r\n    openSubPopup(opts) {\r\n        const subPopup = new SubPopup(opts);\r\n        this._subPopupList.push(subPopup);\r\n        this.element.append(subPopup.element);\r\n        if (typeof opts.afterRender === 'function') {\r\n            waitForRender(opts.afterRender);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 关闭子弹窗\r\n     */\r\n    closeSubPopup() {\r\n        const subPopup = this._subPopupList.pop();\r\n        if (subPopup) subPopup.close();\r\n    }\r\n\r\n\r\n    /**\r\n     * 打开弹窗\r\n     * @param {string|Element|jQuery|object} param \r\n     * @returns {SidePopup}\r\n     */\r\n    static open(param) {\r\n        let popup;\r\n        if (typeof param === 'string' || param instanceof Element || param instanceof $) {\r\n            popup = $(param).data(SidePopup.id);\r\n        } else if (param instanceof Object) {\r\n            popup = new SidePopup(param);\r\n        } else {\r\n            throw new TypeError('错误的参数类型');\r\n        }\r\n        if (popup) {\r\n            popup.open();\r\n            return popup;\r\n        } else {\r\n            throw new Error('组件对象不存在');\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 关闭弹窗\r\n     * @param {string|Element|jQuery} param \r\n     */\r\n    static close(param) {\r\n        const popup = $(param).data(SidePopup.id);\r\n        if (popup) popup.close();\r\n    }\r\n}\r\n"],"names":["backdrop","attrs","header","show","tag","showCloseBtn","body","footer","buttons","html","type","initDialog","instance","opts","options","$content","$","append","$header","map","v","k","join","$btn","click","_","close","title","addedClass","addClass","initHeader","initBody","$footer","$parent","each","item","onClick","initButtons","$dialog","width","css","$el","waitForRender","fn","Promise","resolve","then","setTimeout","SubPopup","extend","element","this","remove","SidePopup","id","length","replace","document","constructor","event","target","_subPopupList","closeSubPopup","data","initSidePopup","appendTo","afterRender","removeClass","subPopup","push","pop","param","popup","Element","Object","TypeError","open","Error"],"mappings":"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"}